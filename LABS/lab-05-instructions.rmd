---
title: 'Lab 05 - Predicting MHV Change'
output:
  html_document:
    theme: readable
    df_print: paged
    highlight: tango
    toc: yes
    toc_float: no
    css: 'lab-instructions.css'
    includes:
      after_body: 'footer.html'
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=F, warning=F, eval=T)
library( dplyr )
library( pander )
```


<br>


---

<br>

This lab is designed to help you build a baseline model of neighborhood change. 




# Part 1 - Data

Follow the steps from the tutorial to create a dataset that includes 2000 and 2010 census variables and make sure to: 

* Drop all rural census tracts.
* Create a variable that measures the growth of median home value from 2000 to 2010. 
* Omit cases that have a median home value less than $1,000 in 2000. 
* Omit cases with growth rates above 200%.  

Print summary statistics about median home values in 2000 and 2010. 

Visualize the distribution of changes across all urban tracts between 2000 and 2010 (these are replications of steps in the tutorial as well). 



# Part 2 - Predict MHV Change 

Select three neighborhood characteristics from 2000 that you feel will be good predictors of change in MHV between 2000 and 2010. Note these are static snapshots of the tracts in 2000. 

Explain why you selected the three variables and your theory about how they should related to home value changes. 

Check for variable skew on each of the variables by generating a histogram and summary statistics. Correct skew if necessary. 

Create a correlation plot for your three variables. Are any of them highly-correlated? Do you expect multicollinearity to be a problem? 

Run two models - one with change in median home value (dollar amount) and one with median home value growth (percent change) from 2000 to 2010 as the dependent variables, and include your three year 2000 tract descriptors as covariates. 

What are the results? Did any of the variables predict changes to home value? 

Explain your findings to a general audience. 



# Part 3 - Distribution of Home Values in Your City  

**BONUS QUESTION:**

This step will not be graded this week. 

However, you will need to complete it for your final project, so make your life easier by doing it now and receiving feedback. 

Load the dorling cartogram for your selected city. 

Merge the current census dataset to your dorling shapefile. 

```{r, eval=F}
# geoid-01 is the hypothetical name of tract ID in the shapefile
# geoid-02 is the hypothetical name of tract ID in the census dataset

# dorling must be an sp shapefile 

d <- merge( dorling, census, by.x="geoid-01", by.y="geoid-02", all.x=TRUE )
```


You may have to convert tract GEOIDs so they follow the same format (all numbers): 

```{r, eval=F}
x <- d$tractid 
head( x )
# [1] "fips-01-001-020100" "fips-01-001-020200" "fips-01-001-020300"
# [4] "fips-01-001-020400" "fips-01-001-020500" "fips-01-001-020600"

x <- gsub( "fips", "", x )
x <- gsub( "-", "", x )
head( x )
# [1] "01001020100" "01001020200" "01001020300" "01001020400" "01001020500"
# [6] "01001020600"

x <- as.numeric( x )

# remember to add the variable back to the dataset
d$tractid2 <- x 
```


Create three choropleth maps:

1. Home values in 2000 
2. Home values in 2010 
3. Change in home values 2000-2010

First, display histograms of each variable to determine whether skew exists. 

Select a reasonable binning strategy or create your own.  

Use sequential scales for home values in 2000 and 2010, light for low, dark for high. Use a color ramp with 5 to 11 bins.  

Use a divergent scale for change in home values, red (or an equivalent color) representing loss in value, blue (or an equivalent color) representing gain in value, and gray representing no change in value. Use a color ramp with 5 to 11 bins. 

Do losses and gains cluster together on the map? Where do the largest gains occur? 




-----


<br>

# Submission Instructions

Record your work in an RMD file where you can document your code and responses to the questions. Knit your RMD file and include your rendered HTML file. 

Note that this lab will become one chapter in your final report. You will save time by drafting the lab as if it is an external report chapter rather than a regular lab. 

Login to Canvas at <http://canvas.asu.edu> and navigate to the assignments tab in the course repository. Upload your zipped folder to the appropriate lab submission link.

Remember to:

* name your files according to the convention: **Lab-##-LastName.Rmd**
* show your solution, include your code.
* do not print excessive output (like a full data set).
* follow appropriate style guidelines (spaces between arguments, etc.).

See [Google's R Style Guide](https://google.github.io/styleguide/Rguide.xml) for examples.


---

<br>

## Notes on Knitting

If you are having problems with your RMD file, visit the [**RMD File Styles and Knitting Tips**](https://ds4ps.org/cpp-526-spr-2020/labs/r-markdown-files.html) manual.

Note that when you knit a file, it starts from a blank slate. You might have packages loaded or datasets active on your local machine, so you can run code chunks fine. But when you knit you might get errors that functions cannot be located or datasets don't exist. Be sure that you have included chunks to load these in your RMD file.

Your RMD file will not knit if you have errors in your code. If you get stuck on a question, just add `eval=F` to the code chunk and it will be ignored when you knit your file. That way I can give you credit for attempting the question and provide guidance on fixing the problem.


<br>
<hr>
<br>

<style>
blockquote {
    padding: 11px 22px;
    margin: 0 0 22px;
    font-size: 18px;
    border-left: 5px solid lightgray;
}

</style>

